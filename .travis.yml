sudo: required
dist: trusty
addons:
  apt:
    sources:
    - chef-stable-trusty
    packages:
    - chefdk
install: echo "skip bundle install"
branches:
  only:
  - master
services: docker
env:
  matrix:
  - INSTANCE=default-ubuntu-1404
before_script:
- sudo iptables -L DOCKER || ( echo "DOCKER iptables chain missing" ; sudo iptables
  -N DOCKER )
- eval "$(/opt/chefdk/bin/chef shell-init bash)"
- chef gem install kitchen-ec2
- chef gem install kitchen-docker
- chef gem install kitchen-transport-rsync
- "/opt/chefdk/bin/chef exec rake tests"
script:
- KITCHEN_LOCAL_YAML=.kitchen.yml
- travis_wait 30 /opt/chefdk/embedded/bin/kitchen verify ${INSTANCE}
after_script:
- "/opt/chefdk/embedded/bin/kitchen destroy ${INSTANCE}"
notifications:
  email:
    on_success: change
    on_failure: always
  slack:
    secure: iZPFw9BHqJDpTlxoSdw01IFG0PrHFv9ZLN4G/If30KZrYmGH14926rqQhEeU72UX5BKyssKQymg2fT1e40fNAc5Q+4vmDu0x3jEZh5NFbLG3hGlUNRNdf89TwaEAqRbs4XgWrSTiLTRhl3ioABFhPzEZUBLoHSZHDSuzxjjfAlPcG54Mw62uyWNoQZ6/V0kjRFzFKejW4FJdniyOzhtCq0juzlOVvstTmGIW+ePwn2caBcgUzsD6dTV2jlASYCLkShdFWbvLnGjtmpaE7+fHO5gcfeSORN5Qm1a/d2ZmfSlLzfXlCU653rd4dl4/ugT88RLDb/DNdIfGO3JKslFNcLNqDRVmudhMYYA+n+CtjcV+K9OWxDR/gsDWWLRGcj25VGXrwK4WM6S5SQIvyx7L3MlQdvNsYqPeiIBU7jQ533P9jsk4dNGrMdUGYgYg7/fcg9FJFjAIJZzMDWKCQRRuQ70pyql5BuUtA1X3f9YVaTvhSQBab2LTW/Hob2tu6Wc35loE6QdhiVqnRVHK8e8QQm7IVWSsPJyqsowczxXLmKbCvm/WzQ992LYEuqsVushuTHYv6ep9V5EUnmbHA6xLHqy00wAANRp014d0FTdiT9Ni/R8QBJW+nn9kfQu81nm/mCZaI8Z9Vcx0Jfh0x4ckD5AzH8u4yKbDa9B0AemWuWU=
